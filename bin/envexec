#!/bin/bash

${CONSULHOST:="127.0.0.1"}

complain_and_exit() {
  echo "Must provide APPLICATION_NAME env variable"
  exit 1
}

test -n "$APPLICATION_NAME" || complain_and_exit

exec envconsul \
  -consul "$CONSULHOST:8500" \
  -sanitize \
  -upcase \
  -prefix _wakeful/_env/global \
  -prefix _wakeful/_env/$APPLICATION_NAME \
  $@
